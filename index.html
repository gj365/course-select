<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>选课时间表（测试）</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
    }
    table {
      border-collapse: collapse;
      margin-top: 20px;
      width: 100%;
      max-width: 900px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      font-size: 14px;
    }
    th {
      background: #f4f4f4;
    }
    td.slot {
      cursor: pointer;
      background: #e8f5e9;
    }
    td.full {
      background: #f8d7da;
      color: #888;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

<h2>选课时间表（剩余名额）</h2>

<table id="schedule">
  <thead>
    <tr>
      <th>时间</th>
      <th>3/31</th>
      <th>4/1</th>
      <th>4/2</th>
      <th>4/3</th>
      <th>4/4</th>
    </tr>
  </thead>
  <tbody>
    <!-- JS 自动生成 -->
  </tbody>
</table>

<script>
  const dates = ["3/31", "4/1", "4/2", "4/3", "4/4"];
  const MAX_SLOTS = 2;
  const tbody = document.querySelector("#schedule tbody");

  // 生成时间段：9:00 → 17:00（每 30 分）
  function generateTimeSlots() {
    const slots = [];
    let hour = 9;
    let minute = 0;

    while (hour < 17) {
      const start = formatTime(hour, minute);
      minute += 30;
      if (minute === 60) {
        minute = 0;
        hour++;
      }
      const end = formatTime(hour, minute);
      slots.push(`${start} - ${end}`);
    }
    return slots;
  }

  function formatTime(h, m) {
    return `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}`;
  }

  function renderTable() {
    const timeSlots = generateTimeSlots();

    timeSlots.forEach(time => {
      const tr = document.createElement("tr");

      // 第一列：时间段
      const timeTd = document.createElement("td");
      timeTd.textContent = time;
      tr.appendChild(timeTd);

      // 后面的日期列
      dates.forEach(date => {
        const td = document.createElement("td");
        td.className = "slot";
        td.dataset.remaining = MAX_SLOTS;
        td.textContent = MAX_SLOTS;

        td.onclick = () => {
          let remain = Number(td.dataset.remaining);
          if (remain <= 0) return;

          remain--;
          td.dataset.remaining = remain;

          if (remain === 0) {
            td.textContent = "已满";
            td.className = "full";
          } else {
            td.textContent = remain;
          }
        };

        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });
  }

  renderTable();
</script>

</body>
</html>
