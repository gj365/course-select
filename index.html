<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>Supabase 连接测试</title>
</head>
<body>
  <h2>Supabase 连接测试</h2>

  <div>
    <input id="email" placeholder="邮箱" />
    <input id="name" placeholder="名字" />
    <input id="kana" placeholder="假名" />
    <button onclick="testEnroll()">测试写入</button>
  </div>

  <pre id="result"></pre>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    const supabase = window.supabase.createClient(
      "https://course-select.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlvZGlqbmhieGloYXN0dWtucWt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4NjgyNTIsImV4cCI6MjA4NTQ0NDI1Mn0.PTG1s0Zv14VX-yfrZNmJqyu-R7wlvJl3_YYcq40g6Y4"
    );

    async function testEnroll() {
      const email = document.getElementById("email").value;
      const name = document.getElementById("name").value;
      const kana = document.getElementById("kana").value;

      const { error } = await supabase.rpc("enroll_time_slot", {
        p_time_slot: "test-slot",
        p_name: name,
        p_kana: kana,
        p_email: email
      });

      document.getElementById("result").textContent =
        error ? "❌ 失败: " + error.message : "✅ 成功：已写入数据库";
    }
  </script>
</body>
</html>